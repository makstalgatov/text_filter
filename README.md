# iTest text filter

–ü—Ä–æ—Å—Ç–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç. –ë—ç–∫–µ–Ω–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç, –Ω–∞—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å "42123", –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –∑–∞ –Ω–∏–º–∏ —Å—Ç—Ä–æ–∫—É, –µ—Å–ª–∏ –æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ–º (–≤–æ–∑–º–æ–∂–Ω–æ, —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º "+"). –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

*   –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –±–∞–∑–µ HTML, CSS, JavaScript.
*   –ë—ç–∫–µ–Ω–¥ –Ω–∞ FastAPI.
*   –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.
*   –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
*   –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä—è–º–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
*   –ö–Ω–æ–ø–∫–∞ "Copy" –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.
*   –ö–Ω–æ–ø–∫–∞ "Clear" –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ–ª—è –≤–≤–æ–¥–∞.
*   –°—á–µ—Ç—á–∏–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
*   Favicon.
*   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é Docker –∏ Docker Compose.
*   –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –≤ Docker –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏ —Å HTTPS (–∏—Å–ø–æ–ª—å–∑—É—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç).

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **–ë—ç–∫–µ–Ω–¥:** Python, FastAPI, Uvicorn
*   **–§—Ä–æ–Ω—Ç–µ–Ω–¥:** HTML, CSS, JavaScript
*   **–®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä:** Jinja2
*   **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker, Docker Compose
*   **–í–µ–±-—Å–µ—Ä–≤–µ—Ä/–ü—Ä–æ–∫—Å–∏:** Nginx (–≤ Docker)

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/makstalgatov/text_filter.git
    cd text_filter
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
    ```bash
    python3 -m venv .venv
    source .venv/bin/activate
    # –î–ª—è Windows: .venv\Scripts\activate
    ```

3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å Uvicorn:**
    ```bash
    uvicorn main:app --reload
    ```

5.  –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://127.0.0.1:8000`.

### –° –ø–æ–º–æ—â—å—é Docker Compose (–¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è/–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ Nginx –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ Docker Compose:** –°–ª–µ–¥—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è –≤–∞—à–µ–π –û–°.

2.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/makstalgatov/text_filter.git
    cd text_filter
    ```

3.  **–°–æ–∑–¥–∞–π—Ç–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
    *   Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS. –î–ª—è —ç—Ç–æ–≥–æ —Ç—Ä–µ–±—É—é—Ç—Å—è SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –∫–ª—é—á. –°–æ–∑–¥–∞–π—Ç–µ –∏—Ö –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –ø–∞–ø–∫—É `nginx/ssl/`. **–ó–∞–º–µ–Ω–∏—Ç–µ `<your-ip-or-domain>` –Ω–∞ IP-–∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.**
        ```bash
        mkdir -p nginx/ssl
        openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
             -keyout nginx/ssl/nginx-selfsigned.key \
             -out nginx/ssl/nginx-selfsigned.crt \
             -subj "/CN=<your-ip-or-domain>"
        ```
    *   ***–í–∞–∂–Ω–æ:*** –ï—Å–ª–∏ –≤—ã —É–∂–µ –¥–æ–±–∞–≤–∏–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ Git, —ç—Ç–æ—Ç —à–∞–≥ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.

4.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é Docker Compose:**
    ```bash
    docker compose up --build -d
    ```
    *   `--build` –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.
    *   `-d` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

5.  –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É `https://<your-ip-or-domain>`.
    *   –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π.

## ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

*   **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å:** `docker compose ps`
*   **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:** `docker compose logs app` –∏–ª–∏ `docker compose logs nginx` (–¥–æ–±–∞–≤—å—Ç–µ `-f` –¥–ª—è —Å–ª–µ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏).
*   **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:** `docker compose down`
*   **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞:** `git pull origin main && docker compose up --build -d`

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
. 
‚îú‚îÄ‚îÄ .git/                # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è Git 
‚îú‚îÄ‚îÄ nginx/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ SSL –¥–ª—è Nginx 
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf 
‚îÇ   ‚îî‚îÄ‚îÄ ssl/ 
‚îÇ       ‚îú‚îÄ‚îÄ nginx-selfsigned.crt 
‚îÇ       ‚îî‚îÄ‚îÄ nginx-selfsigned.key 
‚îú‚îÄ‚îÄ static/              # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (CSS, JS, Favicon) 
‚îÇ   ‚îú‚îÄ‚îÄ css/style.css 
‚îÇ   ‚îú‚îÄ‚îÄ js/script.js 
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico 
‚îú‚îÄ‚îÄ templates/           # HTML —à–∞–±–ª–æ–Ω—ã (Jinja2) 
‚îÇ   ‚îî‚îÄ‚îÄ index.html 
‚îú‚îÄ‚îÄ .gitignore           # –§–∞–π–ª—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ Git 
‚îú‚îÄ‚îÄ Dockerfile           # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏ Docker-–æ–±—Ä–∞–∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è 
‚îú‚îÄ‚îÄ docker-compose.yml   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ (app, nginx) 
‚îú‚îÄ‚îÄ main.py              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è 
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python 
‚îî‚îÄ‚îÄ README.md            # –≠—Ç–æ—Ç —Ñ–∞–π–ª 
``` 

## Configuration

To enable the "With Samples (ELK Lookup)" feature, you need to configure the following environment variables before running the application:

*   `ELK_URL`: The full URL to your Elasticsearch search endpoint (e.g., `http://elk.example.com:9200/filebeat-*/_search`).
*   `ELK_USER`: The username for Elasticsearch authentication.
*   `ELK_PASSWORD`: The password for Elasticsearch authentication.
*   `ELK_TIMEOUT` (Optional): The timeout in seconds for Elasticsearch queries (defaults to 15).

**Example (Linux/macOS):**

```bash
export ELK_URL="http://your-elk-url/.../_search"
export ELK_USER="your_elk_user"
export ELK_PASSWORD="your_elk_password"
uvicorn main:app --host 0.0.0.0 --port 8000
```

**Example (Docker Compose):**

You can add these variables to the `environment` section of the `web` service in your `docker-compose.yml` file:

```yaml
services:
  web:
    # ... other settings ...
    environment:
      - ELK_URL=http://your-elk-url/.../_search
      - ELK_USER=your_elk_user
      - ELK_PASSWORD=your_elk_password
      - ELK_TIMEOUT=20 # Optional
    # ...
```

If these variables are not set, the application will still run, but the "With Samples (ELK Lookup)" logic will log a warning and will not be able to fetch data from Elasticsearch.

## Running the Application

# ... (rest of README) ... 